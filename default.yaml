data:
  db_path: 'db/app.db'
  sql_train: |
    SELECT source_code, error_text, label
    FROM training_data
  source_code: "source_code"
  error_text: "error_text"
  label: "label"


features:
  lowercase: false
  token_pattern: "(?u)\\b\\w\\w+\\b" # TODO
  ngram_range: [1, 4]

  TfidfVectorizer:
    sublinear_tf: true # использовать логарифмическую зависимость для TF
    max_df: 1.0 # не отсекать
    min_df: 1   # не отсекать
  
  CountVectorizer:
    max_df: 1.0 # не отсекать
    min_df: 1   # не отсекать
  
  HashingVectorizer:
    n_features: 1048576
    alternate_sign: true


cross_val_score:
  scoring: ["accuracy", "f1"]
  cv:
    type: ["StratifiedKFold", "KFold"]
    n_splits: 5
    shuffle: true
    random_state: 42
  n_jobs: -1


metrics:
  - "accuracy"
  - "f1"
  - "roc_auc"


save_models:
  dir: "models"                # корневая папка артефактов
  pattern: "{ts}/{model_name}" # подпапка на модель/запуск
  # итоговые файлы: sklearn -> model.joblib; keras -> keras_model/


db_log:
  enable: true
  db_path: 'db/experiments.db'
  # таблицы создадим автоматически, см. ниже


active_models:
  - "logreg"
  - "rf"
  - "svm_rbf"
  - "nb"
  - "keras_mlp"


models:
  logreg:
    type: "sklearn.linear_model.LogisticRegression"
    params:
      max_iter: 1000
      class_weight: "balanced"
      n_jobs: -1
    # опц.: сетка под GridSearchCV
    grid: { C: [0.1, 1.0, 10.0] }

  rf:
    type: "sklearn.ensemble.RandomForestClassifier"
    params:
      n_estimators: 300
      max_depth: null
      n_jobs: -1
      class_weight: "balanced"

  svm_rbf:
    type: "sklearn.svm.SVC"
    params:
      kernel: "rbf"
      C: 3.0
      gamma: "scale"
      probability: true
      class_weight: "balanced"

  nb:
    type: "sklearn.naive_bayes.MultinomialNB"
    params:
      alpha: 0.1

  keras_mlp:
    type: "keras_mlp"     # нестандартный тип — обрабатываем отдельно
    params:
      hidden_units: 128
      dropout: 0.3
      lr: 0.001
      batch_size: 512
      epochs: 5